# mybrow-extension
Документация по созданию расширений для Мой Браузер
Это руководство объясняет, как создавать расширения для браузера Мой Браузер, разработанного на основе PyQt5 и QWebEngineView. Расширения добавляют функциональность, внедряя скрипты, изменяя страницы или взаимодействуя с состоянием браузера. Настоящая документация актуальна на 18 августа 2025 года и соответствует версии V5.0.
Обзор
Расширения в Мой Браузер похожи на WebExtensions для Chrome или Firefox, но адаптированы под архитектуру данного браузера. Они загружаются как ZIP-файлы, содержащие manifest.json и вспомогательные файлы (например, HTML, JavaScript, CSS). Браузер извлекает и выполняет эти файлы, применяя контентные скрипты к соответствующим URL или запуская фоновые скрипты.
Предварительные требования

Python 3.11 или 3.12 с установленными PyQt5, PyQtWebEngine и requests.
Базовые знания HTML, JavaScript и JSON.
Текстовый редактор и утилита для создания ZIP-архивов.

Структура расширения
Папка расширения или ZIP-файл должна содержать:

manifest.json: Файл конфигурации, описывающий метаданные и поведение расширения.
popup.html: (Опционально) HTML-файл для всплывающего окна, вызываемого действием браузера.
background.js: (Опционально) JavaScript для фоновых задач.
Другие файлы (например, иконки, скрипты), указанные в manifest.json.

Создание manifest.json
Файл manifest.json — центральный элемент конфигурации. Ниже приведен минимальный пример:
{
  "manifest_version": 2,
  "name": "Мое расширение",
  "version": "1.0",
  "description": "Пример расширения для Мой Браузер",
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  },
  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"]
    }
  ],
  "permissions": ["tabs"]
}

Ключевые поля

manifest_version: Используйте 2 (поддерживаемая версия).
name: Название расширения (обязательно).
version: Номер версии (обязательно).
description: Краткое описание.
browser_action: Определяет кнопку в панели инструментов с иконкой и опциональным всплывающим окном.
default_icon: Путь к иконке размером 24x24 в формате PNG.
default_popup: Путь к HTML-файлу всплывающего окна.


content_scripts: Указывает скрипты для внедрения в веб-страницы.
matches: Паттерны URL (например, "<all_urls>" для всех страниц).
js: Массив JavaScript-файлов для внедрения.


permissions: Необходимые права (например, tabs для управления вкладками).

Написание контентных скриптов
Контентные скрипты выполняются в контексте веб-страниц. Создайте файл content.js для изменения страницы:
// content.js
console.log("Контентный скрипт внедрен на " + window.location.href);
document.body.style.backgroundColor = "#f0f0f0";

Этот пример выводит URL в консоль и изменяет цвет фона. Соответствуйте шаблону в matches из manifest.json.
Добавление действия браузера
Для добавления кнопки в панель инструментов включите browser_action в manifest.json и создайте popup.html:
<!-- popup.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Мое всплывающее окно</title>
    <style>
        body { padding: 10px; font-family: Arial, sans-serif; }
        button { padding: 5px 10px; }
    </style>
</head>
<body>
    <button onclick="alert('Привет из всплывающего окна!')">Нажми меня</button>
</body>
</html>

Кнопка появится в панели инструментов, а при нажатии откроется всплывающее окно.
Упаковка расширения

Создайте папку (например, moe_rasshirenie).
Добавьте manifest.json, popup.html, icon.png и content.js.
Создайте ZIP-архив: zip -r moe_rasshirenie.zip moe_rasshirenie/.
В Мой Браузер используйте "Магазин расширений" (mybrowser://store) или "Управление расширениями" (mybrowser://extensions) для установки ZIP-файла.

Тестирование и отладка

Загрузите расширение через mybrowser://extensions, загрузив ZIP-файл.
Проверяйте консоль (через инструменты отладки Qt или print в browser.py) на наличие ошибок.
Используйте console.log в скриптах для отладки.

Рекомендации

Делайте расширения легковесными и сосредоточенными на одной задаче.
Тестируйте на разных сайтах для обеспечения совместимости.
Избегайте локального ввода-вывода или сетевых вызовов вне контекста браузера.
Используйте относительные пути в manifest.json для всех файлов.

Увеличьте version в manifest.json.
Переупакуйте и переустановите ZIP-файл через mybrowser://extensions.

Для дополнительной помощи свяжитесь с разработчиком (LalkaTM) через страницу "О программе" (mybrowser://about).
