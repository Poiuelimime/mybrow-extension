Документация по созданию расширений для Мой Браузер
Добро пожаловать в документацию по созданию расширений для браузера Мой Браузер, разработанного на основе PyQt5 и QWebEngineView. Эта документация актуальна на 21 августа 2025 года, 12:31 PM EDT и соответствует версии V4.5. Расширения позволяют добавлять функциональность, изменять страницы или взаимодействовать с браузером.
Обзор
Мой Браузер поддерживает расширения, похожие на WebExtensions для Chrome или Firefox, но адаптированные под его архитектуру. Расширения загружаются как ZIP-файлы, содержащие manifest.json и вспомогательные файлы (HTML, JavaScript, CSS). Браузер извлекает их, применяя контентные скрипты к указанным URL или выполняя фоновые задачи.
Установка и требования
Предварительные требования

Python 3.11 или 3.12.
Установленные пакеты: PyQt5, PyQtWebEngine, requests.
Текстовый редактор и утилита для создания ZIP-архивов (например, zip).

Установка зависимостей
Выполните следующую команду для установки необходимых пакетов:
pip install PyQt5 PyQtWebEngine requests

Структура расширения
Расширение должно содержать следующие файлы в папке или ZIP-архиве:

manifest.json: Файл конфигурации с метаданными и поведением.
popup.html: (Опционально) HTML-файл для всплывающего окна, вызываемого кнопкой.
background.js: (Опционально) JavaScript для фоновых задач.
Другие файлы (например, иконки, скрипты), указанные в manifest.json.

Создание manifest.json
Файл manifest.json — основа расширения. Пример минимальной конфигурации:
{
  "manifest_version": 2,
  "name": "Мое расширение",
  "version": "1.0",
  "description": "Пример расширения для Мой Браузер",
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup.html"
  },
  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"]
    }
  ],
  "permissions": ["tabs"]
}

Описание полей



Поле
Описание



manifest_version
Версия манифеста (используйте 2).


name
Название расширения (обязательно).


version
Номер версии (обязательно).


description
Краткое описание.


browser_action
Кнопка в панели инструментов.


- default_icon
Путь к иконке 24x24 в формате PNG.


- default_popup
Путь к HTML-файлу всплывающего окна.


content_scripts
Список скриптов для внедрения в страницы.


- matches
Паттерны URL (например, "<all_urls>").


- js
Массив JavaScript-файлов.


permissions
Необходимые права (например, tabs).


Написание контентных скриптов
Контентные скрипты выполняются на веб-страницах. Пример файла content.js:
// content.js
console.log("Контентный скрипт внедрен на " + window.location.href);
document.body.style.backgroundColor = "#f0f0f0";

Этот скрипт выводит URL в консоль и изменяет цвет фона. Убедитесь, что он соответствует matches в manifest.json.
Создание всплывающего окна
Для добавления кнопки в панель инструментов создайте popup.html. Пример:
<!-- popup.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Мое всплывающее окно</title>
    <style>
        body { padding: 10px; font-family: Arial, sans-serif; }
        button { padding: 5px 10px; }
    </style>
</head>
<body>
    <button onclick="alert('Привет из всплывающего окна!')">Нажми меня</button>
</body>
</html>

Кнопка появится в панели, а при нажатии откроется всплывающее окно.
Упаковка расширения

Создайте папку (например, moe_rasshirenie).
Добавьте manifest.json, popup.html, icon.png (иконка 24x24) и content.js.
Создайте ZIP-архив:zip -r moe_rasshirenie.zip moe_rasshirenie/


В Мой Браузер перейдите на mybrowser://store или mybrowser://extensions и загрузите ZIP-файл для установки.

Тестирование и отладка

Загрузите расширение через mybrowser://extensions.
Проверяйте консоль (через инструменты отладки Qt или print в browser.py) на ошибки.
Используйте console.log в скриптах для отладки.

Рекомендации

Делайте расширения легковесными и сосредоточенными на одной задаче.
Тестируйте на разных сайтах для совместимости.
Избегайте локального ввода-вывода или сетевых вызовов вне контекста браузера.
Используйте относительные пути в manifest.json.

Обновление расширений

Увеличьте version в manifest.json.
Переупакуйте и переустановите ZIP-файл через mybrowser://extensions.

Лицензия
Этот проект распространяется под лицензией MIT. См. файл LICENSE для деталей.
Связь с разработчиком
Для вопросов или предложений свяжитесь с разработчиком (LalkaTM) через страницу "О программе" (mybrowser://about) в браузере.

Документация обновлена: 21 августа 2025 года, 12:31 PM EDT
